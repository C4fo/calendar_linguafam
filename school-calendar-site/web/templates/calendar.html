<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css' rel='stylesheet' />
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js'></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/ru.min.js'></script>
</head>
<body>
    <!-- Overlay –¥–ª—è –¥–∏–∞–ª–æ–≥–æ–≤ -->
    <div class="overlay" id="overlay"></div>
    
    <div class="container calendar-container">
        <!-- –•–µ–¥–µ—Ä -->
        <header class="header">
            <div>
                <h1>üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–Ω—è—Ç–∏–π</h1>
                <p>{{ student_name }} | –†–æ–ª—å: {{ role | capitalize }}</p>
            </div>
            <a href="/" class="btn btn-secondary">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
        </header>
        
        <div class="content-wrapper">
            <!-- –°–∞–π–¥–±–∞—Ä -->
            <aside class="sidebar">
                <div class="sidebar-section">
                    <h3>üë§ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                    <p><strong>–£—á–µ–Ω–∏–∫:</strong> {{ student_name }}</p>
                    <p><strong>–†–æ–¥–∏—Ç–µ–ª—å:</strong> {{ parent_name }}</p>
                    <p><strong>ID —É—á–µ–Ω–∏–∫–∞:</strong> {{ student_id }}</p>
                </div>
                
                <div class="sidebar-section">
                    <h3>üìö –ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ —É—Ä–æ–∫–∏</h3>
                    <div id="lessons-list" class="lessons-list">
                        <!-- –ó–∞–≥—Ä—É–∑–∏—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3>üîÑ –ü–µ—Ä–µ–Ω–æ—Å —É—Ä–æ–∫–∞</h3>
                    <button class="btn btn-primary btn-block" id="reschedule-btn">
                        üîÑ –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —É—Ä–æ–∫
                    </button>
                    <p class="help-text">–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–∫ —Å–ª–µ–≤–∞ –∏–ª–∏ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ</p>
                </div>
                
                <div class="sidebar-section">
                    <h3>üìä –ó–∞–Ω—è—Ç–æ—Å—Ç—å (–Ω–µ–¥–µ–ª—è)</h3>
                    <div class="availability">
                        <div class="availability-item">
                            <span class="color-dot student-busy"></span>
                            <span>–£—á–µ–Ω–∏–∫: <strong id="student-hours">0</strong> —á</span>
                        </div>
                        <div class="availability-item">
                            <span class="color-dot teacher-busy"></span>
                            <span>–£—á–∏—Ç–µ–ª—å: <strong id="teacher-hours">0</strong> —á</span>
                        </div>
                    </div>
                </div>
            </aside>
            
            <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
            <main class="main-content">
                <div class="calendar-header">
                    <h2>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</h2>
                    <div class="legend">
                        <div class="legend-item">
                            <span class="color-dot lesson-single"></span>
                            <span>–†–∞–∑–æ–≤—ã–π —É—Ä–æ–∫</span>
                        </div>
                        <div class="legend-item">
                            <span class="color-dot lesson-regular"></span>
                            <span>–†–µ–≥—É–ª—è—Ä–Ω—ã–π —É—Ä–æ–∫</span>
                        </div>
                        <div class="legend-item">
                            <span class="color-dot student-busy"></span>
                            <span>–£—á–µ–Ω–∏–∫ –∑–∞–Ω—è—Ç</span>
                        </div>
                        <div class="legend-item">
                            <span class="color-dot teacher-busy"></span>
                            <span>–£—á–∏—Ç–µ–ª—å –∑–∞–Ω—è—Ç</span>
                        </div>
                    </div>
                </div>
                
                <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å -->
                <div id="calendar"></div>
            </main>
        </div>
    </div>
    
    <!-- –î–∏–∞–ª–æ–≥ –ø–µ—Ä–µ–Ω–æ—Å–∞ —É—Ä–æ–∫–∞ -->
    <div class="dialog" id="reschedule-dialog">
        <div class="dialog-header">
            <h3>üîÑ –ü–µ—Ä–µ–Ω–æ—Å —É—Ä–æ–∫–∞</h3>
            <button class="dialog-close" onclick="closeDialog()">√ó</button>
        </div>
        
        <div class="dialog-body">
            <!-- –®–∞–≥ 1: –í—ã–±–æ—Ä —Ç–∏–ø–∞ –ø–µ—Ä–µ–Ω–æ—Å–∞ -->
            <div id="step-1">
                <p class="dialog-question">–ß—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏?</p>
                
                <div class="options-grid">
                    <div class="option-card" onclick="selectTransferType('nearest')">
                        <div class="option-icon">üìÖ</div>
                        <h4>–ë–ª–∏–∂–∞–π—à–∏–π —É—Ä–æ–∫</h4>
                        <p>–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å–∞–º—ã–π –±–ª–∏–∂–∞–π—à–∏–π —É—Ä–æ–∫</p>
                        <div class="lesson-info" id="nearest-lesson-info">
                            –ó–∞–≥—Ä—É–∑–∫–∞...
                        </div>
                    </div>
                    
                    <div class="option-card" onclick="selectTransferType('regular')">
                        <div class="option-icon">üîÑ</div>
                        <h4>–†–µ–≥—É–ª—è—Ä–Ω—ã–π —É—Ä–æ–∫</h4>
                        <p>–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤—Å–µ –∑–∞–Ω—è—Ç–∏—è –∏–∑ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</p>
                    </div>
                    
                    <div class="option-card" onclick="selectTransferType('specific')">
                        <div class="option-icon">üéØ</div>
                        <h4>–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —É—Ä–æ–∫</h4>
                        <p>–í—ã–±—Ä–∞—Ç—å —É—Ä–æ–∫ –∏–∑ —Å–ø–∏—Å–∫–∞ –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞</p>
                    </div>
                </div>
            </div>
            
            <!-- –®–∞–≥ 2: –í—ã–±–æ—Ä –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ -->
            <div id="step-2" style="display: none;">
                <h4 id="step-title"></h4>
                
                <div class="form-group">
                    <label>üìÖ –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:</label>
                    <div id="date-selector" class="date-selector">
                        <!-- –ó–∞–≥—Ä—É–∑–∏—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <div class="form-group">
                    <label>üïê –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:</label>
                    <div id="time-slots" class="time-slots">
                        <!-- –ó–∞–≥—Ä—É–∑–∏—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <div id="confirmation" class="confirmation" style="display: none;">
                    <p>‚úÖ –í—ã–±—Ä–∞–Ω–æ: <strong id="selected-slot"></strong></p>
                </div>
            </div>
        </div>
        
        <div class="dialog-footer">
            <button class="btn btn-secondary" onclick="closeDialog()">–û—Ç–º–µ–Ω–∞</button>
            <button class="btn btn-primary" id="next-btn" onclick="nextStep()">–î–∞–ª–µ–µ</button>
            <button class="btn btn-primary" id="confirm-btn" style="display: none;" onclick="confirmReschedule()">
                –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–µ—Ä–µ–Ω–æ—Å
            </button>
        </div>
    </div>
    
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –Ω–∞—à JS -->
    <script src="/static/calendar.js"></script>
    <script>
        // –ü–µ—Ä–µ–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —à–∞–±–ª–æ–Ω–∞ –≤ JS
        window.studentId = {{ student_id }};
        window.role = '{{ role }}';
    </script>
</body>
</html>